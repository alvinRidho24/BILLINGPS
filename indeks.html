<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Responsive PS Billing System</title>
<style>
  /* Reset and base */
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #eee;
    display: flex;
    justify-content: center;
    padding: 15px;
    min-height: 100vh;
    box-sizing: border-box;
  }

  .container {
    background: linear-gradient(145deg, #1f2937, #111827);
    border-radius: 12px;
    width: 100%;
    max-width: 960px;
    box-shadow: 5px 5px 20px #000, -5px -5px 20px #2a2f3a;
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
    grid-gap: 20px;
  }

  .part {
    background: #212b40;
    border-radius: 12px;
    box-shadow: inset 2px 2px 8px #172030,
                inset -2px -2px 8px #2b3a5a;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 15px;
  }

  .part h3 {
    color: #60a5fa;
    margin-bottom: 12px;
    font-weight: 700;
    user-select: none;
    font-size: 1.25rem;
    text-align: center;
  }

  select {
    width: 100%;
    padding: 8px 10px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
    background: #374151;
    color: #eee;
    outline-offset: 2px;
  }

  .timer-display {
    margin-top: 8px;
    color: #f87171;
    font-weight: 700;
    font-size: 1.1rem;
    user-select: none;
    min-height: 24px;
    text-align: center;
  }

  button.generate {
    margin-top: 12px;
    padding: 10px 0;
    width: 100%;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    background-color: #2563eb;
    border: none;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  button.generate:hover {
    background-color: #1e40af;
  }

  .receipt {
    grid-column: 1 / -1;
    background: #111827;
    border-radius: 12px;
    padding: 15px;
    font-family: monospace, monospace;
    white-space: pre-wrap;
    max-height: 160px;
    overflow-y: auto;
    color: #a5b4fc;
    user-select: text;
    margin-top: 10px;
  }

  /* Scrollbar styling for desktops */
  .receipt::-webkit-scrollbar {
    width: 8px;
  }

  .receipt::-webkit-scrollbar-thumb {
    background: #374151;
    border-radius: 4px;
  }

  /* Mobile tweaks */
  @media (max-width: 600px) {
    body {
      padding: 10px 5px;
    }

    .part h3 {
      font-size: 1.1rem;
    }

    button.generate {
      font-size: 1rem;
      padding: 8px 0;
    }
  }
</style>
</head>
<body>
  <div class="container" role="main" aria-label="Responsive PS Billing System">
    <div class="part" id="part-TV1">
      <h3>TV 1</h3>
      <select aria-label="Select rental duration for TV 1"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 1">Generate Bill</button>
    </div>
    <div class="part" id="part-TV2">
      <h3>TV 2</h3>
      <select aria-label="Select rental duration for TV 2"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 2">Generate Bill</button>
    </div>
    <div class="part" id="part-TV3">
      <h3>TV 3</h3>
      <select aria-label="Select rental duration for TV 3"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 3">Generate Bill</button>
    </div>
    <div class="part" id="part-TV4">
      <h3>TV 4</h3>
      <select aria-label="Select rental duration for TV 4"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 4">Generate Bill</button>
    </div>
    <div class="part" id="part-TV5">
      <h3>TV 5</h3>
      <select aria-label="Select rental duration for TV 5"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 5">Generate Bill</button>
    </div>
    <div class="part" id="part-TV6">
      <h3>TV 6</h3>
      <select aria-label="Select rental duration for TV 6"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for TV 6">Generate Bill</button>
    </div>
    <div class="part" id="part-PS4">
      <h3>PS4</h3>
      <select aria-label="Select rental duration for PS4"></select>
      <div class="timer-display" aria-live="polite" aria-atomic="true"></div>
      <button class="generate" aria-label="Generate bill for PS4">Generate Bill</button>
    </div>
    <pre class="receipt" id="receiptArea" aria-live="polite" tabindex="0"></pre>
  </div>
<script>
  (function() {
    const maxIncrements = 6;
    function generateDurationsList(base30m, base1h, halfHourIncrement, count) {
      const result = [];
      for(let i=1; i<=count; i++) {
        let label = '';
        let hours = Math.floor(i/2);
        let minutes = (i % 2) * 30;
        if(hours > 0) label += hours + (hours === 1 ? ' Jam' : ' Jam ');
        if(minutes > 0) label += minutes + ' Menit';
        if(label === '') label = '0 Menit';
        let price = 0;
        if(i === 1) price = base30m;
        else if(i === 2) price = base1h;
        else price = base1h + (i - 2) * halfHourIncrement;
        price = Math.ceil(price / 1000) * 1000;
        result.push({label, price});
      }
      return result;
    }
    const ps3Durations = generateDurationsList(5000, 9000, 4500, maxIncrements);
    const ps4Durations = generateDurationsList(7000, 13000, 6500, maxIncrements);

    const parts = {
      "part-TV1": "ps3",
      "part-TV2": "ps3",
      "part-TV3": "ps3",
      "part-TV4": "ps3",
      "part-TV5": "ps3",
      "part-TV6": "ps3",
      "part-PS4": "ps4"
    };
    const countdowns = {};
    let timerInterval = null;

    function formatRupiah(num) {
      return "Rp" + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return m.toString().padStart(2, "0") + ":" + s.toString().padStart(2, "0");
    }
    function labelToMinutes(label) {
      const hrMatch = label.match(/(\d+)\s*Jam/);
      const mnMatch = label.match(/(\d+)\s*Menit/);
      let total = 0;
      if (hrMatch) total += parseInt(hrMatch[1]) * 60;
      if (mnMatch) total += parseInt(mnMatch[1]);
      return total;
    }

    function initSelects() {
      Object.keys(parts).forEach(partId => {
        const partType = parts[partId];
        const container = document.getElementById(partId);
        const select = container.querySelector("select");
        select.innerHTML = "";
        const durations = partType === "ps3" ? ps3Durations : ps4Durations;
        durations.forEach((dur, i) => {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = `${dur.label} (${formatRupiah(dur.price)})`;
          select.appendChild(option);
        });
        select.addEventListener("change", () => {
          const timerDisp = container.querySelector(".timer-display");
          timerDisp.textContent = "";
        });
      });
    }

    function updateTimers() {
      const now = Date.now();
      let activeFound = false;
      Object.keys(parts).forEach(partId => {
        const endTime = countdowns[partId];
        const container = document.getElementById(partId);
        const timerDisplay = container.querySelector(".timer-display");
        if (endTime && endTime > now) {
          const secondsLeft = Math.floor((endTime - now) / 1000);
          timerDisplay.textContent = "Time left: " + formatTime(secondsLeft);
          activeFound = true;
        } else if (endTime) {
          timerDisplay.textContent = "Time's up! ‚è∞";
          delete countdowns[partId];
        } else {
          timerDisplay.textContent = "";
        }
      });
      if (!activeFound && timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function startTimerInterval() {
      if (timerInterval) return;
      timerInterval = setInterval(updateTimers, 1000);
    }

    function generateBillForPart(partId) {
      const partType = parts[partId];
      const container = document.getElementById(partId);
      const select = container.querySelector("select");
      const selectedIdx = select.selectedIndex;
      if (selectedIdx < 0) {
        alert(`Please select duration for ${container.querySelector("h3").textContent}!`);
        select.focus();
        return null;
      }
      const durations = partType === "ps3" ? ps3Durations : ps4Durations;
      const dur = durations[selectedIdx];
      const price = dur.price;
      const minutes = labelToMinutes(dur.label);
      countdowns[partId] = Date.now() + minutes * 60000;
      updateTimers();
      startTimerInterval();
      return { device: container.querySelector("h3").textContent, duration: dur.label, price };
    }

    const receiptArea = document.getElementById("receiptArea");

    Object.keys(parts).forEach(partId => {
      const container = document.getElementById(partId);
      const btn = container.querySelector("button.generate");
      btn.addEventListener("click", () => {
        const bill = generateBillForPart(partId);
        if (!bill) return;
        let receiptLines = receiptArea.textContent ? receiptArea.textContent.split("\n") : [];
        receiptLines = receiptLines.filter(line => !line.startsWith(bill.device));
        receiptLines.push(`${bill.device.padEnd(6)} : ${bill.duration.padEnd(10)} ${formatRupiah(bill.price)}`);
        let total = 0;
        receiptLines.forEach(line => {
          const priceMatch = line.match(/Rp[\d\.]+$/);
          if (priceMatch) {
            let val = priceMatch[0].replace(/Rp|\\./g, "");
            val = parseInt(val);
            total += val;
          }
        });
        const header = "=== PS Billing Receipt ===";
        const divider = "------------------------";
        const totalLine = "TOTAL  : " + formatRupiah(total);
        const thank = "\nThank you for playing! üéÆ";
        const receiptText = [header, ...receiptLines, divider, totalLine, thank].join("\n");
        receiptArea.textContent = receiptText;
        receiptArea.focus();
      });
    });

    initSelects();
    updateTimers();
  })();
</script>
</html>
